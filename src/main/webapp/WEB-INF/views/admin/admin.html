<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:include="masterlayout/masterpage :: headFragment">
    <title>Admin</title>
</head>
<body id="skin-blur-violate" th:attr="id=${session.userSkin}">
<!-- <header id="header" class="media" th:include="masterlayout/masterpage :: headerFragment"></header> -->

<div class="clearfix"></div>

<section id="main" class="p-relative" role="main">
    <!-- Side Menu -->
    <ul class="list-unstyled side-menu hidden-xs" th:include="common/sidebar/_sidemenu :: sidemenuFragment"/>

    <!-- Sidebar -->
    <aside id="sidebar" th:include="common/sidebar/_sidebar :: sidebarFragment"/>

    <!-- Content -->
    <section id="content" class="container">
        <h2 class="page-title">Root Admin</h2>

        <div class="block-area">
            <div class="filter-time">
                <!--<a href="addUser" id="createNewUser" class="btn">Create New User</a>-->

                <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#modalCreateUser" id="btn-create">
                    Create new User
                </button>

            </div>
            <div th:if="${user != null}" class="modal" id="modalCreateUser" tabindex="-1" role="dialog"
                 aria-labelledby="exampleModalLabel">
                <form action="saveUser" th:action="@{/admin/saveUser}" role="form" class="form-validation-1"
                      method="post" th:object="${user}" data-toggle="validator" id="createDialogForm">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                        aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title" id="exampleModalLabel">Create New User</h4>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label for="emailUser" class="control-label">User Email:</label>
                                    <input type="hidden" th:field="*{userId}" id="idUser"/>
                                    <input type="text" class="form-control validate[required,custom[email]]" th:field="*{userEmail}" id="emailUser" />
                                    <!--<small data-th-if="${#fields.hasErrors('userEmail')}"
                                           data-th-errors="*{userEmail}" th:errors="*{userEmail}"></small>-->
                                    <small class="hidden label label-danger" id="error-message-mail">Email already used. Please choose another mail!</small>
                                </div>
                                <div class="form-group">
                                    <label for="roleUser" class="control-label">User Role:</label>
                                    <select class="form-control" id="roleUser" name="roleId">
                                        <option th:each="role : ${roles}" th:text="${role.getRoleName()}"
                                                th:value="${role.getRoleId()}">Admin
                                        </option>
                                    </select>
                                </div>
                                <div class="form-group" id="activeUser">
                                    <label for="roleUser" class="control-label">User Status:</label>
                                    <select class="form-control" name="user_status" id="userStatus">
                                        <option value="1">Enabled</option>
                                        <option value="0">Disabled</option>
                                    </select>
                                </div>
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                            </div>
                            <div class="modal-footer">
                                <button type="submit" class="btn btn-primary btn-submit">Create User</button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Dialog confirm when delete user -->
            <div  class="modal" id="modalDeleteUser" tabindex="-1" role="dialog"
                  aria-labelledby="exampleModalLabel">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title">Delete Confirm</h4>
                        </div>
                        <div class="modal-body">
                            <p>Are you sure to delete user:&nbsp; <strong id="selectedUser" ></strong>&nbsp;? </p>
                        </div>
                        <div class="modal-footer">
                            <a class="btn btn-primary" id="idUserDelete" href="#">Delete User</a>
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End delete dialog -->
        </div>

        <hr class="whiter"/>
        <div class="block-area" id="tableStriped">
            <h3 class="block-title">List Users</h3>

            <div class="table-responsive overflow" tabindex="5005" style="overflow: hidden; outline: none;">
                <table class="tile table table-bordered table-hover table-responsive">
                    <thead>
                    <tr>
                        <th class="hidden"></th>
                        <th width="13"><input type="checkbox" class="checkbox"/></th>
                        <th>User name</th>
                        <th>User email</th>
                        <th>Role</th>
                        <th>Date</th>
                        <th>Active</th>
                        <th>Content Control</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="user : ${page.getContent()}">
                        <td class="hidden"><input type="text" th:value="${user.userId}"/></td>
                        <td class="hidden"><input type="text" th:value="${user.isEnable()}"/></td>
                        <td class="hidden"><input type="text" th:value="${user.getFirstRoleId()}"/></td>
                        <td class="vertical-align-table"><input type="checkbox" class="checkbox"/></td>
                        <td class="vertical-align-table ellipsis" th:text="${user.userName}"></td>
                        <td class="vertical-align-table ellipsis" th:text="${user.userEmail}"></td>
                        <td class="vertical-align-table" th:if="${user.getRole() != null}" th:text="${user.getRole().getRoleName()}"></td>
                        <td class="vertical-align-table" th:unless="${user.getRole() != null}"></td>
                        <td class="vertical-align-table ellipsis" th:text="${#dates.format(user.createDate, 'dd-MMM-yyyy:mm-hh a')}"></td>
                        <td class="vertical-align-table" th:text="${user.isEnable()}"></td>
                        <td><a class="btn btn-alt btn-edit btn-sm" data-toggle="modal" data-target="#modalCreateUser"><i class="icon">
                            &#61952;</i> Edit</a>
                            <a class="btn btn-alt btn-delete btn-sm" data-th-id="${user.userId}" data-th-content="${user.userName}" data-toggle="modal" href="#modalDeleteUser" th:onclick="'confirmDeleteUser(' + @{'/admin/deleteUser/?' + ${user.userId}} + ');'" ><i class="icon">
                                &#61918;</i> Delete</a></td>
                    </tr>
                    <tr th:if="${page.getTotalPages() > 1}">
                        <td colspan="7" class="noHover">
                            <!-- Pagging -->
                            <ul class="btn-group pull-right pagination">
                                <li ><a th:if="${!page.isFirstPage()}" th:href="@{'/admin/?index=' + ${page.getNumber() - 1}}">&laquo;</a></li>
                                <li th:each="pageNumber:${#numbers.sequence(0, page.getTotalPages() - 1)}"  >
                                    <a th:if="${page.getNumber() == pageNumber}" class="active"  th:text="${pageNumber+1}" th:href="@{'/admin/?index=' + ${pageNumber}}"></a>
                                    <a th:if="${page.getNumber() != pageNumber}" th:text="${pageNumber+1}" th:href="@{'/admin/?index=' + ${pageNumber}}"></a>
                                </li>
                                <li ><a th:if="${!page.isLastPage()}" th:href="@{'/admin/?index=' + ${page.getNumber() + 1}}">&raquo;</a></li>
                            </ul>
                            <!-- End Pagging -->
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <hr class="whiter"/>
    </section>

    <!-- Older IE Message -->
    <!--[if lt IE 9]>
    <div class="ie-block" th:include="dashboard/_ie9block :: ie9BlockFragment"/>
    <![endif]-->
</section>
<div th:include="masterlayout/masterpage :: pluginScriptLibraryFragment" ></div>
<script src="/resources/javascript/admin.js" th:src="@{/resources/javascript/admin.js}"></script>
</body>

</html>